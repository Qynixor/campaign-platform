{% extends 'main/face.html' %}
{% load static %}
{% block content %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recreate Campaign</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
      <style>
:root {
    --primary: #1877f2;
    --primary-dark: #166fe5;
    --primary-light: #e7f3ff;
    --secondary: #f0f2f5;
    --text-primary: #1c1e21;
    --text-secondary: #65676b;
    --border: #dddfe2;
    --card-bg: #ffffff;
    --success: #42b72a;
    --error: #f02849;
    --warning: #f7b928;
    --canva-pink: #ff4b4b;
    --canva-orange: #ff9c4b;
    --card-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    --transition: all 0.2s ease;
    --input-bg: #ffffff;
    --input-text: #1c1e21;
    --input-placeholder: #8a8d91;
}

body {
    font-family: 'Segoe UI', Helvetica, Arial, sans-serif;
    background-color: var(--secondary);
    color: var(--text-primary);
    line-height: 1.5;
    margin: 0;
    padding: 0;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
}

.create-wrapper {
    flex: 1;
    padding: 20px 12px;
    display: flex;
    flex-direction: column;
}

.create-container {
    max-width: 480px;
    margin: 0 auto;
    width: 100%;
}

.create-card {
    background-color: var(--card-bg);
    border-radius: 12px;
    box-shadow: var(--card-shadow);
    overflow: hidden;
    margin-bottom: 24px;
    transition: var(--transition);
}

.create-card:hover {
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.12);
}

.card-header {
    padding: 20px 24px;
    border-bottom: 1px solid var(--border);
    display: flex;
    align-items: center;
    background-color: #fafbfc;
}

.card-header h1 {
    margin: 0;
    font-size: 22px;
    font-weight: 700;
    color: var(--text-primary);
    flex: 1;
    display: flex;
    align-items: center;
}

.card-header h1 i {
    margin-right: 12px;
    color: var(--primary);
}

.close-btn {
    background: none;
    border: none;
    font-size: 24px;
    color: var(--text-secondary);
    cursor: pointer;
    padding: 0;
    width: 38px;
    height: 38px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: var(--transition);
}

.close-btn:hover {
    background-color: var(--secondary);
    color: var(--text-primary);
}

.card-body {
    padding: 24px;
}

.form-section {
    margin-bottom: 24px;
    position: relative;
}

.section-label {
    display: flex;
    align-items: center;
    margin-bottom: 16px;
    padding-bottom: 8px;
    border-bottom: 1px solid var(--border);
}

.section-icon {
    width: 32px;
    height: 32px;
    background-color: var(--primary-light);
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 12px;
    color: var(--primary);
}

.section-label-text {
    font-weight: 600;
    font-size: 18px;
    color: var(--text-primary);
}

.form-label {
    display: block;
    font-weight: 600;
    margin-bottom: 8px;
    color: var(--text-primary);
    font-size: 14px;
}

.form-input, .form-select, .form-textarea {
    width: 100%;
    padding: 12px 16px;
    border: 1px solid var(--border);
    border-radius: 8px;
    font-family: inherit;
    font-size: 15px;
    background-color: var(--input-bg);
    color: var(--input-text);
    box-sizing: border-box;
    transition: var(--transition);
}

.form-input:focus, .form-select:focus, .form-textarea:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 3px rgba(24, 119, 242, 0.2);
}

.form-input::placeholder, .form-textarea::placeholder {
    color: var(--input-placeholder);
    opacity: 0.8;
}

.form-textarea {
    min-height: 120px;
    resize: vertical;
    line-height: 1.5;
}

.form-helper {
    color: var(--text-secondary);
    font-size: 13px;
    margin-top: 6px;
    display: block;
}

.file-upload {
    border: 2px dashed var(--border);
    border-radius: 8px;
    padding: 24px;
    text-align: center;
    cursor: pointer;
    transition: var(--transition);
    background-color: #fbfbfb;
}

.file-upload:hover {
    border-color: var(--primary);
    background-color: rgba(24, 119, 242, 0.03);
}

.file-upload i {
    font-size: 28px;
    color: var(--text-secondary);
    margin-bottom: 10px;
}

.file-upload-text {
    font-size: 15px;
    color: var(--text-secondary);
    font-weight: 500;
}

.preview-container {
    margin-top: 16px;
    text-align: center;
}

.preview-image {
    max-width: 100%;
    max-height: 200px;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.submit-button {
    background: linear-gradient(to right, var(--primary), var(--primary-dark));
    color: white;
    border: none;
    border-radius: 8px;
    padding: 14px 28px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: var(--transition);
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 24px auto 0;
    min-width: 180px;
    box-shadow: 0 2px 6px rgba(24, 119, 242, 0.3);
}

.submit-button:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(24, 119, 242, 0.4);
}

.submit-button:active {
    transform: translateY(0);
}

.submit-button i {
    margin-right: 8px;
}

.error-container {
    background-color: rgba(240, 40, 73, 0.08);
    border-left: 4px solid var(--error);
    border-radius: 6px;
    padding: 16px;
    margin-bottom: 24px;
    color: var(--error);
    font-size: 14px;
}

.error-container ul {
    margin: 10px 0 0;
    padding-left: 20px;
}

.error-container li {
    margin-bottom: 4px;
}

.two-column {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 16px;
}

@media (max-width: 768px) {
    .two-column {
        grid-template-columns: 1fr;
    }
    
    .create-wrapper {
        padding: 12px 8px;
    }
    
    .card-body {
        padding: 16px;
    }
    
    .card-header {
        padding: 16px;
    }
    
    .section-label {
        margin-bottom: 12px;
    }
}

/* Animation for form elements */
.form-section {
    animation: fadeIn 0.4s ease-out;
}

@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Social media style tags */
.tag-pill {
    display: inline-block;
    background-color: var(--primary-light);
    color: var(--primary);
    padding: 4px 10px;
    border-radius: 16px;
    font-size: 12px;
    font-weight: 500;
    margin-left: 8px;
}

.progress-bar {
    height: 6px;
    background-color: var(--secondary);
    border-radius: 3px;
    margin-bottom: 24px;
    overflow: hidden;
    position: relative;
}

.progress-fill {
    height: 100%;
    background: linear-gradient(to right, var(--primary), var(--primary-dark));
    width: 0%;
    transition: width 0.5s ease;
    border-radius: 3px;
}

.progress-text {
    position: absolute;
    right: 0;
    top: -24px;
    font-size: 13px;
    color: var(--text-secondary);
}

/* Canva Tool Styles */
.canva-tool {
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 20px;
    margin-bottom: 20px;
    background: linear-gradient(to bottom, #ffffff, #f9f9f9);
    position: relative;
    overflow: hidden;
}

.canva-tool::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(to right, var(--canva-pink), var(--canva-orange));
}

.canva-header {
    display: flex;
    align-items: center;
    margin-bottom: 16px;
}

.canva-logo {
    width: 36px;
    height: 36px;
    margin-right: 12px;
    background: linear-gradient(to right, var(--canva-pink), var(--canva-orange));
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: bold;
    box-shadow: 0 2px 6px rgba(255, 75, 75, 0.3);
}

.canva-title {
    font-weight: 700;
    font-size: 17px;
    color: var(--text-primary);
}

.canva-description {
    color: var(--text-secondary);
    font-size: 14px;
    margin-bottom: 20px;
    line-height: 1.5;
}

.canva-button {
    display: flex;
    align-items: center;
    justify-content: center;
    background: linear-gradient(to right, var(--canva-pink), var(--canva-orange));
    color: white;
    border: none;
    border-radius: 8px;
    padding: 12px 20px;
    font-weight: 600;
    font-size: 15px;
    cursor: pointer;
    transition: var(--transition);
    width: 100%;
    box-shadow: 0 2px 6px rgba(255, 75, 75, 0.3);
}

.canva-button:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(255, 75, 75, 0.4);
}

.canva-button:active {
    transform: translateY(0);
}

.canva-button i {
    margin-right: 10px;
}

/* Tool toggle */
.tool-toggle {
    display: flex;
    align-items: center;
    margin-bottom: 16px;
    padding: 12px 16px;
    background-color: #f8f9fa;
    border-radius: 8px;
}

.toggle-text {
    font-size: 15px;
    color: var(--text-primary);
    margin-left: 12px;
    font-weight: 500;
}

.toggle-switch {
    position: relative;
    display: inline-block;
    width: 44px;
    height: 24px;
}

.toggle-switch input {
    opacity: 0;
    width: 0;
    height: 0;
}

.toggle-slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #ccc;
    transition: .4s;
    border-radius: 34px;
}

.toggle-slider:before {
    position: absolute;
    content: "";
    height: 18px;
    width: 18px;
    left: 3px;
    bottom: 3px;
    background-color: white;
    transition: .4s;
    border-radius: 50%;
}

input:checked + .toggle-slider {
    background: linear-gradient(to right, var(--canva-pink), var(--canva-orange));
}

input:checked + .toggle-slider:before {
    transform: translateX(20px);
}

/* Status indicators */
.canva-status {
    margin-top: 16px;
    padding: 12px;
    border-radius: 8px;
    text-align: center;
    font-size: 14px;
    display: none;
}

.status-success {
    background-color: rgba(66, 183, 42, 0.1);
    color: var(--success);
    border: 1px solid rgba(66, 183, 42, 0.2);
}

.status-error {
    background-color: rgba(240, 40, 73, 0.1);
    color: var(--error);
    border: 1px solid rgba(240, 40, 73, 0.2);
}

.status-loading {
    background-color: rgba(24, 119, 242, 0.1);
    color: var(--primary);
    border: 1px solid rgba(24, 119, 242, 0.2);
}

.status-loading .spinner {
    display: inline-block;
    width: 16px;
    height: 16px;
    border: 2px solid rgba(24, 119, 242, 0.3);
    border-radius: 50%;
    border-top-color: var(--primary);
    animation: spin 1s ease-in-out infinite;
    margin-right: 8px;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

.optional-badge {
    display: inline-block;
    background-color: #f0f2f5;
    color: var(--text-secondary);
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 12px;
    font-weight: 500;
    margin-left: 8px;
}

/* Audio Restrictions Warning - Light Mode */
.audio-restrictions-warning {
    background: linear-gradient(135deg, #fff9e6 0%, #fff3cd 100%);
    border: 2px solid #ffeaa7;
    border-radius: 12px;
    padding: 20px;
    margin: 15px 0;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.warning-header {
    display: flex;
    align-items: center;
    gap: 10px;
    color: #856404;
    margin-bottom: 15px;
    font-size: 1.1em;
}

.warning-header i {
    font-size: 1.3em;
}

.restriction-content {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin: 15px 0;
}

.allowed-list, .restricted-list {
    padding: 15px;
    border-radius: 8px;
}

.allowed-list {
    background: rgba(40, 167, 69, 0.1);
    border: 1px solid rgba(40, 167, 69, 0.3);
}

.restricted-list {
    background: rgba(220, 53, 69, 0.1);
    border: 1px solid rgba(220, 53, 69, 0.3);
}

.allowed-list h4, .restricted-list h4 {
    margin: 0 0 10px 0;
    font-size: 0.95em;
    display: flex;
    align-items: center;
    gap: 8px;
}

.allowed-list ul, .restricted-list ul {
    margin: 0;
    padding-left: 20px;
    font-size: 0.85em;
    color: #555;
}

.allowed-list li, .restricted-list li {
    margin-bottom: 5px;
    line-height: 1.4;
}

.warning-footer {
    border-top: 1px solid #ffeaa7;
    padding-top: 15px;
    margin-top: 10px;
}

.warning-footer p {
    margin: 0;
    font-size: 0.9em;
    color: #856404;
    text-align: center;
}

/* Audio Preview Styles - Light Mode */
.audio-preview {
    display: flex;
    align-items: center;
    gap: 15px;
    padding: 15px;
    border-radius: 8px;
    margin: 10px 0;
}

.audio-preview.approved {
    background: rgba(40, 167, 69, 0.1);
    border: 1px solid rgba(40, 167, 69, 0.3);
}

.audio-preview.rejected {
    background: rgba(220, 53, 69, 0.1);
    border: 1px solid rgba(220, 53, 69, 0.3);
}

.preview-icon {
    font-size: 1.5em;
}

.preview-icon .fa-check-circle {
    color: #28a745;
}

.preview-icon .fa-exclamation-circle {
    color: #dc3545;
}

.preview-info {
    flex: 1;
}

.audio-details {
    display: flex;
    gap: 15px;
    margin: 5px 0;
    font-size: 0.85em;
    color: #666;
}

.preview-status {
    font-size: 0.9em;
    font-weight: 500;
}

.preview-loading {
    text-align: center;
    padding: 20px;
    color: #666;
}

/* Sub elements styling */
.sub {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 14px;
    padding: 14px;
    border-radius: 10px;
    background: #ffffff;
    border: 1px solid #e5e7eb;
    transition: transform 0.2s ease;
}

.sub:hover {
    transform: translateY(-2px);
}

.sub i {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 38px;
    height: 38px;
    font-size: 16px;
    background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
    color: #4b5563;
    border-radius: 50%;
    flex-shrink: 0;
    border: 1px solid #f9fafb;
}

.sub h2 {
    margin: 0;
    font-size: 18px;
    font-weight: 600;
    color: #1f2937;
}

.sub p {
    margin: 5px 0 0;
    font-size: 13px;
    color: #6b7280;
    line-height: 1.45;
}

/* Responsive design */
@media (max-width: 768px) {
    .restriction-content {
        grid-template-columns: 1fr;
        gap: 15px;
    }
    
    .audio-restrictions-warning {
        padding: 15px;
    }
}

/* Text colors for light mode */
.text-success {
    color: #28a745 !important;
}

.text-danger {
    color: #dc3545 !important;
}

/* Style select dropdown for light mode */
select.form-select {
    appearance: none;
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='%2365676b' viewBox='0 0 16 16'%3e%3cpath d='M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z'/%3e%3c/svg%3e");
    background-repeat: no-repeat;
    background-position: right 12px center;
    background-size: 16px 12px;
}

/* Override browser autofill styles for light mode */
input:-webkit-autofill,
input:-webkit-autofill:hover, 
input:-webkit-autofill:focus,
textarea:-webkit-autofill,
textarea:-webkit-autofill:hover,
textarea:-webkit-autofill:focus,
select:-webkit-autofill,
select:-webkit-autofill:hover,
select:-webkit-autofill:focus {
    -webkit-text-fill-color: var(--input-text);
    -webkit-box-shadow: 0 0 0px 1000px var(--input-bg) inset;
    transition: background-color 5000s ease-in-out 0s;
    border: 1px solid var(--border);
}

            </style>


    <style type="text/css">
        


    .sub {
    display: flex;
    align-items: center;
    gap: 12px; /* slightly bigger */
    margin-bottom: 14px; 
    padding: 14px; /* increased */
    border-radius: 10px; 
    background: #ffffff;
    border: 1px solid #e5e7eb;
    transition: transform 0.2s ease;
}

.sub:hover {
    transform: translateY(-2px); 
}

.sub i {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 38px;   /* increased */
    height: 38px;  /* increased */
    font-size: 16px; /* slightly bigger */
    background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
    color: #4b5563;
    border-radius: 50%;
    flex-shrink: 0;
    border: 1px solid #f9fafb;
}

.sub h2 {
    margin: 0;
    font-size: 18px;  /* slightly larger */
    font-weight: 600;
    color: #1f2937;
}

.sub p {
    margin: 5px 0 0;
    font-size: 13px;  /* increased */
    color: #6b7280;
    line-height: 1.45;
}

        /* Dark mode for sub elements */
        body.dark-mode .sub {
            background: #1e1e1e;
            border: 1px solid #333;
        }
        
        body.dark-mode .sub i {
            background: linear-gradient(135deg, #2d2d2d 0%, #252525 100%);
            color: #b0b0b0;
            border: 1px solid #333;
        }
        
        body.dark-mode .sub h2 {
            color: #f0f0f0;
        }
        
        body.dark-mode .sub p {
            color: #a0a0a0;
        }
</style>


<style>
    /* Dark mode styles */
.dark-mode {
    --primary: #2d88ff;
    --primary-dark: #1a7ae6;
    --primary-light: rgba(45, 136, 255, 0.15);
    --secondary: #18191a;
    --text-primary: #e4e6ea;
    --text-secondary: #b0b3b8;
    --border: #3e4042;
    --card-bg: #242526;
    --success: #45d62f;
    --error: #fa3e3e;
    --warning: #f7b928;
    --canva-pink: #ff6b6b;
    --canva-orange: #ffa56b;
    --card-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
    --input-bg: #3a3b3c;
    --input-text: #e4e6ea;
    --input-placeholder: #8a8d91;
}

.dark-mode body {
    background-color: var(--secondary);
    color: var(--text-primary);
}

.dark-mode .create-card {
    background-color: var(--card-bg);
    box-shadow: var(--card-shadow);
}

.dark-mode .create-card:hover {
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.6);
}

.dark-mode .card-header {
    background-color: #2d2d2d;
    border-bottom: 1px solid var(--border);
}

.dark-mode .card-header h1 {
    color: var(--text-primary);
}

.dark-mode .close-btn {
    color: var(--text-secondary);
}

.dark-mode .close-btn:hover {
    background-color: #3a3b3c;
    color: var(--text-primary);
}

.dark-mode .section-label {
    border-bottom: 1px solid var(--border);
}

.dark-mode .section-icon {
    background-color: var(--primary-light);
    color: var(--primary);
}

.dark-mode .section-label-text {
    color: var(--text-primary);
}

.dark-mode .form-label {
    color: var(--text-primary);
}

/* Enhanced input styling for dark mode */
.dark-mode .form-input,
.dark-mode .form-select,
.dark-mode .form-textarea {
    background-color: var(--input-bg);
    border: 1px solid var(--border);
    color: var(--input-text);
    transition: var(--transition);
}

/* Ensure placeholder text is visible */
.dark-mode .form-input::placeholder,
.dark-mode .form-textarea::placeholder {
    color: var(--input-placeholder);
    opacity: 0.8;
}

/* Style select dropdown options */
.dark-mode .form-select option {
    background-color: var(--input-bg);
    color: var(--input-text);
    border: none;
}

.dark-mode .form-input:focus,
.dark-mode .form-select:focus,
.dark-mode .form-textarea:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 3px rgba(45, 136, 255, 0.3);
    background-color: var(--input-bg);
    color: var(--input-text);
}

/* Ensure text remains visible when typing */
.dark-mode .form-input:not(:placeholder-shown),
.dark-mode .form-textarea:not(:placeholder-shown) {
    color: var(--input-text);
    background-color: var(--input-bg);
}

.dark-mode .form-helper {
    color: var(--text-secondary);
}

.dark-mode .file-upload {
    background-color: #2d2d2d;
    border: 2px dashed var(--border);
    color: var(--text-secondary);
}

.dark-mode .file-upload:hover {
    border-color: var(--primary);
    background-color: rgba(45, 136, 255, 0.08);
}

.dark-mode .file-upload i {
    color: var(--text-secondary);
}

.dark-mode .file-upload-text {
    color: var(--text-secondary);
}

.dark-mode .submit-button {
    background: linear-gradient(to right, var(--primary), var(--primary-dark));
    box-shadow: 0 2px 6px rgba(45, 136, 255, 0.4);
    color: white;
}

.dark-mode .submit-button:hover {
    box-shadow: 0 4px 12px rgba(45, 136, 255, 0.6);
    color: white;
}

.dark-mode .error-container {
    background-color: rgba(250, 62, 62, 0.12);
    border-left: 4px solid var(--error);
    color: var(--error);
}

.dark-mode .progress-bar {
    background-color: #3a3b3c;
}

.dark-mode .canva-tool {
    background: linear-gradient(to bottom, #2d2d2d, #242526);
    border: 1px solid var(--border);
}

.dark-mode .canva-tool::before {
    background: linear-gradient(to right, var(--canva-pink), var(--canva-orange));
}

.dark-mode .canva-title {
    color: var(--text-primary);
}

.dark-mode .canva-description {
    color: var(--text-secondary);
}

.dark-mode .canva-button {
    background: linear-gradient(to right, var(--canva-pink), var(--canva-orange));
    box-shadow: 0 2px 6px rgba(255, 107, 107, 0.4);
    color: white;
}

.dark-mode .canva-button:hover {
    box-shadow: 0 4px 12px rgba(255, 107, 107, 0.6);
    color: white;
}

.dark-mode .tool-toggle {
    background-color: #3a3b3c;
}

.dark-mode .toggle-text {
    color: var(--text-primary);
}

.dark-mode .toggle-slider {
    background-color: #5a5b5c;
}

.dark-mode input:checked + .toggle-slider {
    background: linear-gradient(to right, var(--canva-pink), var(--canva-orange));
}

.dark-mode .status-success {
    background-color: rgba(69, 214, 47, 0.12);
    color: var(--success);
    border: 1px solid rgba(69, 214, 47, 0.3);
}

.dark-mode .status-error {
    background-color: rgba(250, 62, 62, 0.12);
    color: var(--error);
    border: 1px solid rgba(250, 62, 62, 0.3);
}

.dark-mode .status-loading {
    background-color: rgba(45, 136, 255, 0.12);
    color: var(--primary);
    border: 1px solid rgba(45, 136, 255, 0.3);
}

.dark-mode .status-loading .spinner {
    border: 2px solid rgba(45, 136, 255, 0.3);
    border-top-color: var(--primary);
}

.dark-mode .optional-badge {
    background-color: #3a3b3c;
    color: var(--text-secondary);
}

.dark-mode .tag-pill {
    background-color: var(--primary-light);
    color: var(--primary);
}

/* Dark mode specific adjustments for better contrast */
.dark-mode .preview-image {
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.5);
}

.dark-mode .progress-text {
    color: var(--text-secondary);
}

/* Additional dark mode improvements for better readability */
.dark-mode .form-section {
    color: var(--text-primary);
}

.dark-mode .two-column {
    color: var(--text-primary);
}

/* Ensure all text elements are properly colored in dark mode */
.dark-mode .card-body {
    color: var(--text-primary);
}

.dark-mode .create-container {
    color: var(--text-primary);
}

/* Style for any additional text elements */
.dark-mode .text-muted {
    color: var(--text-secondary) !important;
}

.dark-mode .text-dark {
    color: var(--text-primary) !important;
}

.dark-mode .bg-light {
    background-color: var(--card-bg) !important;
}

.dark-mode .bg-white {
    background-color: var(--card-bg) !important;
}

/* Improved focus states for accessibility */
.dark-mode .form-input:focus::placeholder,
.dark-mode .form-textarea:focus::placeholder {
    color: var(--input-placeholder);
    opacity: 0.6;
}

/* Ensure dropdowns are styled correctly */
.dark-mode select.form-select {
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='%23b0b3b8' viewBox='0 0 16 16'%3e%3cpath d='M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z'/%3e%3c/svg%3e");
    background-repeat: no-repeat;
    background-position: right 12px center;
    background-size: 16px 12px;
    appearance: none;
}

/* Style for file input text */
.dark-mode input[type="file"] {
    color: var(--text-primary);
}

.dark-mode input[type="file"]::file-selector-button {
    background-color: var(--primary);
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 6px;
    cursor: pointer;
    transition: var(--transition);
}

.dark-mode input[type="file"]::file-selector-button:hover {
    background-color: var(--primary-dark);
}
</style>

<style>
   

/* Dark Mode Styles for Audio Restrictions Warning */
.dark-mode .audio-restrictions-warning {
    background: linear-gradient(135deg, #2a2a1e 0%, #3d3d2a 100%);
    border: 2px solid #5d5d3d;
    border-radius: 12px;
    padding: 20px;
    margin: 15px 0;
    box-shadow: 0 2px 8px rgba(0,0,0,0.3);
    color: var(--text-primary);
}

.dark-mode .warning-header {
    display: flex;
    align-items: center;
    gap: 10px;
    color: #d4b642;
    margin-bottom: 15px;
    font-size: 1.1em;
}

.dark-mode .warning-header i {
    font-size: 1.3em;
    color: #d4b642;
}

.dark-mode .restriction-content {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin: 15px 0;
}

.dark-mode .allowed-list,
.dark-mode .restricted-list {
    padding: 15px;
    border-radius: 8px;
}

.dark-mode .allowed-list {
    background: rgba(40, 167, 69, 0.15);
    border: 1px solid rgba(40, 167, 69, 0.4);
}

.dark-mode .restricted-list {
    background: rgba(220, 53, 69, 0.15);
    border: 1px solid rgba(220, 53, 69, 0.4);
}

.dark-mode .allowed-list h4,
.dark-mode .restricted-list h4 {
    margin: 0 0 10px 0;
    font-size: 0.95em;
    display: flex;
    align-items: center;
    gap: 8px;
    color: var(--text-primary);
}

.dark-mode .allowed-list ul,
.dark-mode .restricted-list ul {
    margin: 0;
    padding-left: 20px;
    font-size: 0.85em;
    color: var(--text-secondary);
}

.dark-mode .allowed-list li,
.dark-mode .restricted-list li {
    margin-bottom: 5px;
    line-height: 1.4;
}

.dark-mode .warning-footer {
    border-top: 1px solid #5d5d3d;
    padding-top: 15px;
    margin-top: 10px;
}

.dark-mode .warning-footer p {
    margin: 0;
    font-size: 0.9em;
    color: #d4b642;
    text-align: center;
}

/* Dark mode for audio preview states */
.dark-mode .audio-preview.approved {
    background: rgba(40, 167, 69, 0.15);
    border: 1px solid rgba(40, 167, 69, 0.4);
    color: var(--text-primary);
}

.dark-mode .audio-preview.rejected {
    background: rgba(220, 53, 69, 0.15);
    border: 1px solid rgba(220, 53, 69, 0.4);
    color: var(--text-primary);
}

.dark-mode .preview-loading {
    color: var(--text-secondary);
}

.dark-mode .audio-details {
    color: var(--text-secondary);
}

/* Responsive design for dark mode */
@media (max-width: 768px) {
    .dark-mode .restriction-content {
        grid-template-columns: 1fr;
        gap: 15px;
    }
    
    .dark-mode .audio-restrictions-warning {
        padding: 15px;
    }
}

/* Ensure text colors work well in dark mode */
.dark-mode .text-success {
    color: #4cd964 !important;
}

.dark-mode .text-danger {
    color: #ff6b6b !important;
}

.dark-mode .form-helper {
    color: var(--text-secondary);
}

/* Force dark mode styling on all form elements */
.dark-mode input[type="text"],
.dark-mode input[type="number"],
.dark-mode input[type="email"],
.dark-mode input[type="password"],
.dark-mode input[type="url"],
.dark-mode textarea,
.dark-mode select {
    background-color: var(--input-bg) !important;
    border: 1px solid var(--border) !important;
    color: var(--input-text) !important;
    padding: 12px 16px !important;
    border-radius: 8px !important;
    font-family: inherit !important;
    font-size: 15px !important;
    width: 100% !important;
    box-sizing: border-box !important;
}

.dark-mode input[type="text"]:focus,
.dark-mode input[type="number"]:focus,
.dark-mode input[type="email"]:focus,
.dark-mode input[type="password"]:focus,
.dark-mode input[type="url"]:focus,
.dark-mode textarea:focus,
.dark-mode select:focus {
    outline: none !important;
    border-color: var(--primary) !important;
    box-shadow: 0 0 0 3px rgba(45, 136, 255, 0.3) !important;
}

.dark-mode input::placeholder,
.dark-mode textarea::placeholder {
    color: var(--input-placeholder) !important;
    opacity: 0.8 !important;
}

/* Style select dropdown specifically */
.dark-mode select {
    appearance: none !important;
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='%23b0b3b8' viewBox='0 0 16 16'%3e%3cpath d='M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z'/%3e%3c/svg%3e") !important;
    background-repeat: no-repeat !important;
    background-position: right 12px center !important;
    background-size: 16px 12px !important;
}

.dark-mode select option {
    background-color: var(--input-bg) !important;
    color: var(--input-text) !important;
}

/* Specific styling for textareas */
.dark-mode textarea {
    min-height: 120px !important;
    resize: vertical !important;
    line-height: 1.5 !important;
}
/* Tags input styling */
.popular-tags {
    margin-top: 10px;
    padding: 10px;
    background: #f8f9fa;
    border-radius: 6px;
}

.popular-tags-title {
    font-size: 12px;
    color: #6c757d;
    margin-bottom: 8px;
    font-weight: 600;
}

.popular-tags-list {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
}

.suggested-tag {
    display: inline-block;
    padding: 4px 12px;
    background: white;
    border: 1px solid #dee2e6;
    border-radius: 20px;
    font-size: 12px;
    color: #495057;
    cursor: pointer;
    transition: all 0.2s;
}

.suggested-tag:hover {
    background: #4a90e2;
    color: white;
    border-color: #4a90e2;
}

/* Transparent Glass Dark Mode for Popular Tags */
.dark-mode .popular-tags {
    margin-top: 10px;
    padding: 12px;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 8px;
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
}

.dark-mode .popular-tags-title {
    font-size: 12px;
    color: rgba(255, 255, 255, 0.8);
    margin-bottom: 10px;
    font-weight: 600;
}

.dark-mode .popular-tags-list {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
}

.dark-mode .suggested-tag {
    display: inline-block;
    padding: 5px 14px;
    background: rgba(255, 255, 255, 0.08);
    border: 1px solid rgba(255, 255, 255, 0.15);
    border-radius: 20px;
    font-size: 12px;
    color: rgba(255, 255, 255, 0.9);
    cursor: pointer;
    transition: all 0.3s ease;
    backdrop-filter: blur(5px);
    -webkit-backdrop-filter: blur(5px);
}

.dark-mode .suggested-tag:hover {
    background: rgba(74, 222, 128, 0.2); /* Green tint */
    border-color: rgba(74, 222, 128, 0.4);
    color: #ffffff;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(74, 222, 128, 0.2);
}

/* Optional: Add a subtle glow effect on hover */
.dark-mode .suggested-tag:hover {
    text-shadow: 0 0 8px rgba(255, 255, 255, 0.3);
}

/* Active state when clicked */
.dark-mode .suggested-tag:active {
    transform: translateY(0);
    transition: transform 0.1s ease;
}
</style>




<style>
/* Slideshow Styles */
.slideshow-info-banner {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 15px;
    border-radius: 10px;
    margin-bottom: 20px;
    display: flex;
    align-items: center;
    gap: 15px;
}

.slideshow-info-banner i {
    font-size: 24px;
}

.slideshow-info-banner strong {
    display: block;
    margin-bottom: 5px;
    font-size: 16px;
}

.slideshow-info-banner p {
    margin: 0;
    font-size: 14px;
    opacity: 0.9;
}

.upload-group {
    margin-bottom: 25px;
    padding: 20px;
    background: #f8f9fa;
    border-radius: 10px;
    border: 1px solid #e9ecef;
}

.upload-label {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 15px;
    font-weight: 600;
    color: #333;
}

.upload-label i {
    color: #667eea;
}

.multi-upload-area {
    border: 2px dashed #667eea;
    border-radius: 10px;
    padding: 40px 20px;
    text-align: center;
    cursor: pointer;
    transition: all 0.3s ease;
    background: rgba(102, 126, 234, 0.05);
}

.multi-upload-area:hover, .multi-upload-area.dragover {
    background: rgba(102, 126, 234, 0.1);
    border-color: #764ba2;
}

.multi-upload-label {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px;
}

.multi-upload-label i {
    font-size: 32px;
    color: #667eea;
}

.upload-text {
    font-size: 16px;
    font-weight: 600;
    color: #333;
}

.upload-count {
    font-size: 12px;
    color: #666;
    background: rgba(102, 126, 234, 0.1);
    padding: 4px 12px;
    border-radius: 20px;
}

.image-previews-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
    gap: 15px;
    margin: 20px 0;
}

.image-preview-item {
    position: relative;
    width: 120px;
    height: 120px;
    border-radius: 8px;
    overflow: hidden;
    border: 2px solid #e9ecef;
}

.image-preview-item.main-preview {
    border-color: #667eea;
    border-width: 3px;
}

.image-preview-item img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.remove-image {
    position: absolute;
    top: 5px;
    right: 5px;
    background: rgba(220, 53, 69, 0.9);
    color: white;
    border: none;
    width: 24px;
    height: 24px;
    border-radius: 50%;
    cursor: pointer;
    font-size: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
}

.remove-image:hover {
    background: #dc3545;
    transform: scale(1.1);
}

.image-info {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background: rgba(0, 0, 0, 0.7);
    color: white;
    padding: 5px;
    font-size: 11px;
    text-align: center;
}

.image-info i {
    margin-right: 5px;
}

.image-count-status {
    background: #e9ecef;
    padding: 10px 15px;
    border-radius: 8px;
    margin: 15px 0;
    display: flex;
    align-items: center;
    gap: 10px;
}

.image-count-status i {
    color: #667eea;
}

/* Slideshow Preview */
.slideshow-preview {
    margin-top: 25px;
    border: 1px solid #e9ecef;
    border-radius: 10px;
    overflow: hidden;
}

.preview-header {
    background: #f8f9fa;
    padding: 15px;
    display: flex;
    align-items: center;
    gap: 10px;
    border-bottom: 1px solid #e9ecef;
    font-weight: 600;
    color: #333;
}

.preview-header i {
    color: #667eea;
}

.preview-images {
    padding: 20px;
    display: flex;
    gap: 15px;
    overflow-x: auto;
    min-height: 200px;
    align-items: center;
    justify-content: center;
}

.preview-slide {
    position: relative;
    width: 200px;
    height: 150px;
    border-radius: 8px;
    overflow: hidden;
    opacity: 0.5;
    transition: opacity 0.3s ease;
    flex-shrink: 0;
}

.preview-slide.active {
    opacity: 1;
    transform: scale(1.05);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
}

.preview-slide img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.slide-number {
    position: absolute;
    top: 8px;
    left: 8px;
    background: rgba(0, 0, 0, 0.7);
    color: white;
    width: 24px;
    height: 24px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    font-weight: bold;
}

.slide-label {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background: rgba(0, 0, 0, 0.7);
    color: white;
    padding: 5px;
    font-size: 11px;
    text-align: center;
}

.preview-placeholder {
    text-align: center;
    color: #999;
    padding: 40px;
}

.preview-placeholder i {
    font-size: 48px;
    margin-bottom: 15px;
    color: #ddd;
}

.preview-controls {
    padding: 15px;
    background: #f8f9fa;
    border-top: 1px solid #e9ecef;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.preview-btn {
    background: #667eea;
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 6px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 14px;
    transition: all 0.3s ease;
}

.preview-btn:hover {
    background: #5a67d8;
    transform: translateY(-2px);
}

.timer-setting {
    display: flex;
    align-items: center;
    gap: 10px;
}

.timer-setting label {
    font-size: 14px;
    color: #666;
}

.timer-setting select {
    padding: 5px 10px;
    border: 1px solid #ddd;
    border-radius: 4px;
    background: white;
}

.no-images {
    text-align: center;
    color: #999;
    padding: 20px;
    font-style: italic;
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .image-previews-grid {
        grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
    }
    
    .preview-slide {
        width: 150px;
        height: 120px;
    }
    
    .preview-controls {
        flex-direction: column;
        gap: 15px;
        align-items: stretch;
    }
}
</style>




</head>

<body>
    <div class="create-wrapper">
        <div class="create-container">
         
            
            <div class="progress-bar">
                <div class="progress-fill" id="formProgress"></div>
                <div class="progress-text" id="progressText">0% complete</div>
            </div>
            
            <div class="create-card">
                <div class="card-header">
                    <h1><i class="fas fa-redo-alt"></i> Recreate Campaign</h1>
                    <button class="close-btn">&times;</button>
                </div>
                
                <div class="card-body">
                    <form method="post" enctype="multipart/form-data" id="campaignForm">
                        {% csrf_token %}
                        
                        <!-- Display Error Messages -->
                        {% if form.errors %}
                            <div class="error-container">
                                <strong>Please correct the following errors:</strong>
                                <ul>
                                    {% for field in form %}
                                        {% for error in field.errors %}
                                            <li>{{ field.label }}: {{ error }}</li>
                                        {% endfor %}
                                    {% endfor %}
                                </ul>
                            </div>
                        {% endif %}
                        
                        <!-- Campaign Basics Section -->
                        <div class="section-label">
                            <div class="section-icon">
                                <i class="fas fa-edit"></i>
                            </div>
                            <div class="section-label-text">Campaign Basics</div>
                        </div>
                        
                        <!-- Title -->
                        <div class="form-section">
                            <label for="{{ form.title.id_for_label }}" class="form-label">Campaign Title</label>
                            {{ form.title }}
                            <span class="form-helper">Choose a clear and engaging title that describes your campaign</span>
                        </div>
                        
                        <!-- Content -->
                        <div class="form-section">
                            <label for="{{ form.content.id_for_label }}" class="form-label">Description</label>
                            {{ form.content }}
                            <span class="form-helper">Be specific about your goals and how people can help</span>
                        </div>
                        
                        <!-- Design Section -->
                        <div class="section-label">
                            <div class="section-icon">
                                <i class="fas fa-paint-brush"></i>
                            </div>
                            <div class="section-label-text">Design & Media</div>
                        </div>
                          

<!-- Slideshow Images Section -->
<div class="form-section">
    <label class="form-label">Slideshow Images</label>
    
    <!-- Slideshow Info Banner -->
    <div class="slideshow-info-banner">
        <i class="fas fa-images"></i>
        <div>
            <strong>Engaging Slideshow Feature</strong>
            <p>Upload multiple images for an automatic slideshow. Campaigns with slideshows get 3x more engagement!</p>
        </div>
    </div>
    
    <!-- Main Poster Upload -->
    <div class="upload-group">
        <label for="id_poster" class="file-upload">
            <i class="fas fa-star"></i>
            <div class="file-upload-text">Click to upload or drag and drop</div>
            <span class="form-helper">PNG, JPG, GIF or WEBP (max. 5MB) - This will be the first image in slideshow</span>
        </label>
        {{ form.poster }}
        <div id="mainPosterPreview" class="preview-container"></div>
    </div>
    
    <!-- Additional Images Upload -->
    <div class="upload-group">
        <label class="upload-label">
            <i class="fas fa-layer-group"></i> Additional Slideshow Images (Optional)
        </label>
        <div class="multi-upload-area" id="multiUploadArea">
            <label for="id_additional_images" class="multi-upload-label">
                <i class="fas fa-plus-circle"></i>
                <div class="upload-text">Click to add more images</div>
                <span class="form-helper">Select multiple images (Ctrl+Click or drag & drop)</span>
                <span class="upload-count">Up to 4 additional images</span>
            </label>
            <!-- Manually add the multiple attribute here -->
            <input type="file" name="additional_images" id="id_additional_images" 
                   multiple accept="image/png, image/jpeg, image/gif, image/webp" 
                   style="display: none;" 
                   onchange="previewAdditionalImages(event)">
        </div>
        
        <!-- Image Previews Grid -->
        <div class="image-previews-grid" id="additionalPreviews"></div>
    </div>
</div>
                        <!-- Audio Upload -->
                      <!-- Replace your current audio upload section with this -->
<div class="form-section">
    <label class="form-label">Campaign Sound <span class="optional-badge">Optional</span></label>
    
    <!-- Audio Restrictions Warning Box -->
    <div class="audio-restrictions-warning">
        <div class="warning-header">
            <i class="fas fa-exclamation-triangle"></i>
            <strong>Audio Usage Guidelines</strong>
        </div>
        <div class="restriction-content">
            <div class="allowed-list">
                <h4><i class="fas fa-check-circle text-success"></i> Allowed</h4>
                <ul>
                    <li>Your original recordings</li>
                    <li>Royalty-free music</li>
                    <li>Sound effects you created</li>
                    <li>Voice recordings</li>
                </ul>
            </div>
            <div class="restricted-list">
                <h4><i class="fas fa-ban text-danger"></i> Restricted</h4>
                <ul>
                    <li>Copyrighted music (pop songs, albums)</li>
                    <li>Audio from movies, TV shows, games</li>
                    <li>Commercial jingles or advertisements</li>
                    <li>Sample packs without proper license</li>
                </ul>
            </div>
        </div>
        <div class="warning-footer">
            <p><strong>Note:</strong> Violations may result in campaign removal and account suspension.</p>
        </div>
    </div>

    <!-- File Upload Area -->
          <label for="id_audio" class="file-upload">
    <i class="fas fa-megaphone"></i> <!-- Changed icon for campaigns -->
    <div class="file-upload-text">Upload Campaign Audio</div>
    <span class="form-helper">MP3 or WAV format (max. 10MB). Recommended: 30-120 seconds for best engagement.</span>
</label>
<input type="file" id="id_audio" name="audio" 
       accept="audio/mpeg, audio/wav, audio/ogg" 
       style="display: none;" onchange="previewAudio(event)">
                        <div id="audioPreview" class="preview-container"></div>
                    </div>
</div>
                        
                        <!-- Settings Section -->
                        <div class="section-label">
                            <div class="section-icon">
                                <i class="fas fa-cog"></i>
                            </div>
                            <div class="section-label-text">Campaign Settings</div>
                        </div>
                        
                        <!-- Category and Visibility -->
                        <div class="two-column">
                            <div class="form-section">
                                <label for="{{ form.category.id_for_label }}" class="form-label">Category</label>
                                {{ form.category }}
                            </div>
                            
<!-- Tags Section -->
<div class="form-section">
    <label for="id_tags_input" class="form-label">Tags <span class="optional-badge">Optional</span></label>
    <input type="text" id="id_tags_input" name="tags_input" class="form-input" 
           placeholder="education, children, school, learning..."
           value="{% if form.tags_input.value %}{{ form.tags_input.value }}{% endif %}">
    <span class="form-helper">
        <i class="fas fa-tags"></i> 
        Add relevant tags separated by commas. This helps people discover your campaign.
    </span>
    
    <!-- Popular tags suggestions -->
    <div class="popular-tags">
        <div class="popular-tags-title">Popular tags:</div>
        <div class="popular-tags-list">
            <span class="suggested-tag" data-tag="education">education</span>
            <span class="suggested-tag" data-tag="children">children</span>
            <span class="suggested-tag" data-tag="community">community</span>
            <span class="suggested-tag" data-tag="health">health</span>
            <span class="suggested-tag" data-tag="environment">environment</span>
            <span class="suggested-tag" data-tag="urgent">urgent</span>
        </div>
    </div>
</div>
                            <div class="form-section">
                                <label for="{{ form.visibility.id_for_label }}" class="form-label">Visibility</label>
                                {{ form.visibility }}
                                <span class="form-helper"><span class="tag-pill">Tip</span> Public campaigns can be discovered by everyone</span>
                            </div>
                        </div>
                        
                        <!-- Duration -->
                        <div class="two-column">
                            <div class="form-section">
                                <label for="{{ form.duration.id_for_label }}" class="form-label">Duration</label>
                                {{ form.duration }}
                            </div>
                            
                            <div class="form-section">
                                <label for="{{ form.duration_unit.id_for_label }}" class="form-label">Unit</label>
                                {{ form.duration_unit }}
                            </div>
                        </div>
                        
                        <!-- Funding Goal -->
                        <div class="form-section">
                            <label for="{{ form.funding_goal.id_for_label }}" class="form-label">Funding Goal <span class="optional-badge">Optional</span></label>
                            {{ form.funding_goal }}
                            <span class="form-helper">Set a fundraising target if needed</span>
                        </div>
                        
                        <!-- Hidden field to store Canva poster data -->
                        <input type="hidden" id="canva_poster_data" name="canva_poster_data">
                        
                        <!-- Submit Button -->
                        <button type="submit" class="submit-button">
                            <i class="fas fa-paper-plane"></i> Recreate Campaign
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>



<script>
      // Image preview function
        function previewImage(event) {
            const fileInput = event.target;
            const previewContainer = document.getElementById('posterPreview');
            previewContainer.innerHTML = '';
            
            const file = fileInput.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = document.createElement('img');
                    img.src = e.target.result;
                    img.alt = 'Poster preview';
                    img.className = 'preview-image';
                    previewContainer.appendChild(img);
                };
                reader.readAsDataURL(file);
            }
        }
        
</script>
   
    <script>
// Form progress indicator
function updateProgress() {
    const form = document.getElementById('campaignForm');
    const inputs = form.querySelectorAll('input, textarea, select');
    const progressFill = document.getElementById('formProgress');
    const progressText = document.getElementById('progressText');
    
    let filledCount = 0;
    inputs.forEach(input => {
        if (input.type === 'hidden' && input.id === 'canva_poster_data' && input.value) {
            filledCount++;
        } else if (input.value.trim() !== '' || (input.type === 'file' && input.files.length > 0)) {
            filledCount++;
        }
    });
    
    const progress = (filledCount / inputs.length) * 100;
    progressFill.style.width = `${progress}%`;
    progressText.textContent = `${Math.round(progress)}% complete`;
}

// Function to check for created poster from GIF creator
function checkForCreatedPoster() {
    const posterData = localStorage.getItem('campaign_poster_data');
    
    if (posterData) {
        try {
            const { data, filename, type, timestamp } = JSON.parse(posterData);
            
            // Check if data is recent (within 5 minutes)
            if (Date.now() - timestamp < 5 * 60 * 1000) {
                // Convert base64 to blob
                fetch(data)
                    .then(res => res.blob())
                    .then(blob => {
                        const file = new File([blob], filename, { type: type });
                        
                        // Create a DataTransfer object to set the file
                        const dataTransfer = new DataTransfer();
                        dataTransfer.items.add(file);
                        
                        // Set the file input
                        const posterInput = document.getElementById('id_poster');
                        posterInput.files = dataTransfer.files;
                        
                        // Trigger preview
                        previewImage({ target: posterInput });
                        
                        // Show success message
                        showNotification('Created poster automatically added to your campaign!', 'success');
                        
                        // Update progress
                        updateProgress();
                        
                        // Clear localStorage
                        localStorage.removeItem('campaign_poster_data');
                    })
                    .catch(error => {
                        console.error('Error processing poster data:', error);
                        localStorage.removeItem('campaign_poster_data');
                    });
            } else {
                // Data is too old, remove it
                localStorage.removeItem('campaign_poster_data');
            }
        } catch (error) {
            console.error('Error loading created poster:', error);
            localStorage.removeItem('campaign_poster_data');
        }
    }
}

// Notification function
function showNotification(message, type = 'success') {
    // Create notification element if it doesn't exist
    let notification = document.querySelector('.campaign-notification');
    if (!notification) {
        notification = document.createElement('div');
        notification.className = 'campaign-notification';
        document.body.appendChild(notification);
        
        // Add some basic styles
        notification.style.cssText = `
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            color: white;
            z-index: 10000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            transform: translateX(400px);
            transition: transform 0.3s ease;
            font-weight: 500;
        `;
    }
    
    // Set content and style based on type
    notification.textContent = message;
    notification.style.background = type === 'success' ? '#10b981' : '#ef4444';
    notification.style.transform = 'translateX(0)';
    
    // Auto-hide after 4 seconds
    setTimeout(() => {
        notification.style.transform = 'translateX(400px)';
        setTimeout(() => notification.remove(), 300);
    }, 4000);
}

// Canva Tool Functionality
document.addEventListener('DOMContentLoaded', function() {
    const formElements = document.querySelectorAll('input, textarea, select');
    formElements.forEach(element => {
        element.addEventListener('input', updateProgress);
        element.addEventListener('change', updateProgress);
    });
    
    // Initialize progress
    updateProgress();
    
    // Check for created poster from GIF creator
    checkForCreatedPoster();
    
    // Close button functionality
    const closeBtn = document.querySelector('.close-btn');
    if (closeBtn) {
        closeBtn.addEventListener('click', function() {
            if(confirm('Are you sure you want to cancel? Your progress will be lost.')) {
                window.history.back();
            }
        });
    }
    
    // Canva tool toggle
    const canvaToggle = document.getElementById('canvaToggle');
    const canvaTool = document.getElementById('canvaTool');
    
    if (canvaToggle && canvaTool) {
        canvaToggle.addEventListener('change', function() {
            canvaTool.style.display = this.checked ? 'block' : 'none';
            updateProgress();
        });
        
        // Initially hide the Canva tool
        canvaTool.style.display = 'none';
    }
    
    // Canva functionality
    const openCanvaButton = document.getElementById('openCanva');
    const canvaPosterData = document.getElementById('canva_poster_data');
    
    // Function to handle Canva poster data
    function handleCanvaPosterData(data) {
        // Store the data in the hidden field
        if (canvaPosterData) {
            canvaPosterData.value = JSON.stringify(data);
        }
        
        // Show success message
        showNotification('Poster created successfully with Canva!', 'success');
        
        // Update form progress
        updateProgress();
    }
    
    // Function to check for Canva response
    function checkForCanvaResponse() {
        // Check if we have a Canva response in localStorage
        const canvaResponse = localStorage.getItem('canva_poster_response');
        if (canvaResponse) {
            try {
                const data = JSON.parse(canvaResponse);
                handleCanvaPosterData(data);
                
                // Clear the stored response
                localStorage.removeItem('canva_poster_response');
            } catch (e) {
                console.error('Error parsing Canva response:', e);
                showNotification('Error loading Canva poster. Please try again.', 'error');
            }
        }
    }
    
    // Check for Canva response on page load
    checkForCanvaResponse();
    
    // Set up storage event listener for cross-tab communication
    window.addEventListener('storage', function(e) {
        if (e.key === 'canva_poster_response') {
            checkForCanvaResponse();
        }
    });
    
    // Set up a message listener for postMessage communication
    window.addEventListener('message', function(event) {
        // Verify the origin for security
        if (event.origin !== window.location.origin) {
            return;
        }
        
        // Check if this is a Canva response
        if (event.data && event.data.type === 'canva_poster_data') {
            handleCanvaPosterData(event.data.payload);
        }
    });
    
    // Fix for Canva button click
    if (openCanvaButton) {
        openCanvaButton.addEventListener('click', function() {
            // Show loading notification
            showNotification('Opening Canva...', 'success');
            
            // Generate a unique ID for this Canva session
            const canvaSessionId = 'canva_' + Date.now();
            
            // Store the session ID to identify responses
            localStorage.setItem('canva_session_id', canvaSessionId);
            
            // Get the Canva URL - make sure this URL is correct
            let canvaUrl = "{% url 'poster_canva' %}";
            
            // If the URL contains the template tag, it won't render properly in JS
            // Use a data attribute instead
            if (canvaUrl.includes('{%')) {
                // Fallback: check if URL is available in a data attribute
                const canvaButton = document.getElementById('openCanva');
                canvaUrl = canvaButton.getAttribute('data-canva-url') || '/poster-canva/';
            }
            
            // Add session ID to URL
            canvaUrl += (canvaUrl.includes('?') ? '&' : '?') + 'session_id=' + encodeURIComponent(canvaSessionId);
            
            // Open Canva in a new tab
            const canvaWindow = window.open(canvaUrl, '_blank');
            
            if (!canvaWindow) {
                // Popup blocked - show error
                showNotification('Popup blocked! Please allow popups for this site and try again.', 'error');
                return;
            }
            
            // Set up polling to check for Canva response
            const checkInterval = setInterval(() => {
                if (canvaWindow.closed) {
                    clearInterval(checkInterval);
                    // Check if we got a response before the window closed
                    setTimeout(checkForCanvaResponse, 1000);
                }
            }, 1000);
        });
    }
    
    // Add drag and drop functionality for file uploads
    const fileUploads = document.querySelectorAll('.file-upload');
    fileUploads.forEach(upload => {
        upload.addEventListener('dragover', function(e) {
            e.preventDefault();
            this.style.borderColor = 'var(--primary)';
            this.style.backgroundColor = 'rgba(24, 119, 242, 0.05)';
        });
        
        upload.addEventListener('dragleave', function(e) {
            e.preventDefault();
            this.style.borderColor = '';
            this.style.backgroundColor = '';
        });
        
        upload.addEventListener('drop', function(e) {
            e.preventDefault();
            this.style.borderColor = '';
            this.style.backgroundColor = '';
            
            const files = e.dataTransfer.files;
            if (files.length) {
                const inputId = this.htmlFor;
                const input = document.getElementById(inputId);
                if (input) {
                    input.files = files;
                    const event = new Event('change', { bubbles: true });
                    input.dispatchEvent(event);
                }
            }
        });
    });
    
    // Also check for poster when page becomes visible (user returns from GIF creator tab)
    document.addEventListener('visibilitychange', function() {
        if (!document.hidden) {
            checkForCreatedPoster();
            checkForCanvaResponse();
        }
    });
});

// Auto-hide error messages after 5 seconds
setTimeout(function() {
    const errorDiv = document.querySelector('.error-container');
    if (errorDiv) {
        errorDiv.style.display = 'none';
    }
}, 5000);
    </script>

    <script>
        // Simple tag suggestions
document.addEventListener('DOMContentLoaded', function() {
    const tagsInput = document.getElementById('id_tags_input');
    const suggestedTags = document.querySelectorAll('.suggested-tag');
    
    // Add suggested tag to input
    suggestedTags.forEach(tag => {
        tag.addEventListener('click', function() {
            const currentValue = tagsInput.value;
            const newTag = this.getAttribute('data-tag');
            
            if (currentValue === '') {
                tagsInput.value = newTag;
            } else {
                // Check if tag already exists
                const existingTags = currentValue.split(',').map(t => t.trim());
                if (!existingTags.includes(newTag)) {
                    tagsInput.value = currentValue + ', ' + newTag;
                }
            }
            
            // Focus back on input
            tagsInput.focus();
        });
    });
    
    // Auto-format as user types (optional)
    tagsInput.addEventListener('blur', function() {
        // Clean up spacing when user leaves the field
        const tags = this.value.split(',')
            .map(tag => tag.trim())
            .filter(tag => tag !== '')
            .join(', ');
        this.value = tags;
    });
});
    </script>




<script type="text/javascript">
    // JavaScript for Slideshow Uploads
let additionalImages = [];
let mainImage = null;

// Create a hidden file input for submitting files
let hiddenFileInputsContainer = document.getElementById('hiddenFileInputsContainer');
if (!hiddenFileInputsContainer) {
    hiddenFileInputsContainer = document.createElement('div');
    hiddenFileInputsContainer.id = 'hiddenFileInputsContainer';
    hiddenFileInputsContainer.style.display = 'none';
    document.getElementById('campaignForm').appendChild(hiddenFileInputsContainer);
}

// Preview main image
function previewMainImage(event) {
    const file = event.target.files[0];
    if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
            mainImage = {
                url: e.target.result,
                file: file,
                isMain: true,
                inputName: 'poster'  // This is the actual field name
            };
            
            const preview = document.getElementById('mainPosterPreview');
            preview.innerHTML = `
                <div class="image-preview-item main-preview">
                    <img src="${e.target.result}" alt="Main poster">
                    <div class="image-info">
                        <i class="fas fa-star"></i> Main Poster
                    </div>
                </div>
            `;
        };
        reader.readAsDataURL(file);
    }
}

// Preview additional images
function previewAdditionalImages(event) {
    const files = Array.from(event.target.files);
    const previewContainer = document.getElementById('additionalPreviews');
    
    // Filter out any existing files and limit to 4
    const newFiles = files.slice(0, 4 - additionalImages.length);
    
    newFiles.forEach((file, index) => {
        const reader = new FileReader();
        
        reader.onload = function(e) {
            const imageData = {
                url: e.target.result,
                file: file,
                isMain: false,
                id: Date.now() + index,
                inputName: `additional_images_${Date.now() + index}`
            };
            
            additionalImages.push(imageData);
            
            renderImagePreviews();
        };
        
        reader.readAsDataURL(file);
    });
    
    // Reset file input to allow adding more images
    event.target.value = '';
}

// Render all image previews
function renderImagePreviews() {
    const previewContainer = document.getElementById('additionalPreviews');
    const countText = document.getElementById('imageCountText') || document.createElement('div');
    
    previewContainer.innerHTML = '';
    
    if (additionalImages.length === 0) {
        previewContainer.innerHTML = '<div class="no-images">No additional images added</div>';
        if (countText) countText.textContent = 'No additional images added yet';
        return;
    }
    
    additionalImages.forEach((image, index) => {
        const previewItem = document.createElement('div');
        previewItem.className = 'image-preview-item';
        previewItem.innerHTML = `
            <img src="${image.url}" alt="Additional image ${index + 1}">
            <button type="button" class="remove-image" onclick="removeImage(${image.id})" title="Remove image">
                <i class="fas fa-times"></i>
            </button>
            <div class="image-info">
                <i class="fas fa-layer-group"></i> Slide ${index + 2}
            </div>
        `;
        previewContainer.appendChild(previewItem);
    });
    
    if (countText) countText.textContent = `${additionalImages.length} additional image${additionalImages.length !== 1 ? 's' : ''} added`;
}

// Remove an image
function removeImage(imageId) {
    additionalImages = additionalImages.filter(img => img.id !== imageId);
    renderImagePreviews();
}

// Handle form submission - CRITICAL FIX
document.getElementById('campaignForm').addEventListener('submit', function(e) {
    // Clear any existing hidden inputs
    document.getElementById('hiddenFileInputsContainer').innerHTML = '';
    
    // Create hidden inputs for additional images
    additionalImages.forEach((image, index) => {
        // Create a new file input for each additional image
        const fileInput = document.createElement('input');
        fileInput.type = 'file';
        fileInput.name = 'additional_images';
        fileInput.style.display = 'none';
        
        // Create a DataTransfer to hold the file
        const dataTransfer = new DataTransfer();
        dataTransfer.items.add(image.file);
        fileInput.files = dataTransfer.files;
        
        // Add to form
        document.getElementById('hiddenFileInputsContainer').appendChild(fileInput);
    });
    
    // Validate at least one image
    const mainFileInput = document.querySelector('input[name="poster"]');
    if (!mainFileInput.files.length && additionalImages.length === 0) {
        e.preventDefault();
        alert('Please upload at least one image for your campaign.');
        return;
    }
    
    // Validate image count
    if (additionalImages.length > 4) {
        e.preventDefault();
        alert('Maximum 4 additional images allowed.');
        return;
    }
    
    console.log('Submitting with:', {
        mainImage: mainFileInput.files.length,
        additionalImages: additionalImages.length
    });
});
</script>


<script type="text/javascript">
    // SIMPLEST SOLUTION - Just validate file type and size
function previewAudio(event) {
    const fileInput = event.target;
    const previewContainer = document.getElementById('audioPreview');
    
    previewContainer.innerHTML = '';
    
    const file = fileInput.files[0];
    if (!file) return;
    
    // Accept common audio formats
    const validTypes = [
        'audio/mpeg', 'audio/mp3', 'audio/wav', 'audio/x-wav',
        'audio/ogg', 'audio/oga', 'audio/x-m4a', 'audio/aac'
    ];
    
    // Also check by extension for mobile compatibility
    const ext = file.name.toLowerCase().split('.').pop();
    const validExts = ['mp3', 'wav', 'ogg', 'm4a', 'aac', 'flac'];
    
    if (!validTypes.includes(file.type) && !validExts.includes(ext)) {
        previewContainer.innerHTML = `
            <p class="form-helper" style="color:#f02849;">
                Unsupported file type. Please use MP3, WAV, or OGG.
            </p>
        `;
        fileInput.value = '';
        return;
    }
    
    // Check size (increase to 10MB for campaigns)
    if (file.size > 10 * 1024 * 1024) {
        previewContainer.innerHTML = `
            <p class="form-helper" style="color:#f02849;">
                File is too large (${(file.size/(1024*1024)).toFixed(1)}MB). Maximum is 10MB.
            </p>
        `;
        fileInput.value = '';
        return;
    }
    
    // Play full audio
    const audio = document.createElement('audio');
    audio.controls = true;
    audio.style.width = '100%';
    audio.style.marginTop = '10px';
    audio.src = URL.createObjectURL(file);
    
    previewContainer.appendChild(audio);
}
</script>
</body>
</html>
{% endblock content %}